<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cluq - Đăng ký</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for animations and specific properties not in Tailwind */
        body {
            background-image: radial-gradient(circle at top left, rgba(0, 188, 212, 0.1) 0%, transparent 40%),
                radial-gradient(circle at bottom right, rgba(0, 188, 212, 0.1) 0%, transparent 40%);
            background-size: 100% 100%;
            background-repeat: no-repeat;
            animation: backgroundShift 20s infinite alternate;
        }

        @keyframes backgroundShift {
            0% {
                background-position: 0% 0%, 100% 100%;
            }

            100% {
                background-position: 100% 100%, 0% 0%;
            }
        }

        .backdrop-blur-md {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .animate-fadeIn {
            animation: fadeIn 1s ease-out forwards;
            opacity: 0;
            will-change: transform, opacity;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .shine-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: all 0.4s ease-out;
            will-change: transform;
        }

        .shine-effect:hover::before {
            left: 100%;
        }

        .form-glow-border {
            position: relative;
            overflow: hidden;
        }

        .form-glow-border::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            right: -20px;
            bottom: -20px;
            background: linear-gradient(45deg, rgba(0, 188, 212, 0.08), rgba(0, 188, 212, 0.02));
            filter: blur(10px);
            -webkit-filter: blur(10px);
            z-index: 0;
            border-radius: 12px;
            will-change: filter;
        }

        /* Responsive Optimization for Mobile Performance */
        @media (max-width: 767px) {
            body {
                animation: none;
                /* Disable backgroundShift on mobile */
                background-image: none;
                /* Remove radial gradients for body */
            }

            .form-glow-border::before {
                filter: none;
                /* Disable blur for form border on mobile */
                -webkit-filter: none;
                background: none;
                /* Remove gradient for form border */
            }

            /* Adjust font sizes and padding for better mobile readability and less clutter */
            h1 {
                font-size: 3.5rem !important;
                /* Smaller on mobile */
            }

            p {
                font-size: 1.1rem !important;
                /* Smaller on mobile */
            }

            h2 {
                font-size: 2.5rem !important;
                /* Smaller on mobile */
            }

            input,
            button {
                font-size: 1rem !important;
                /* Smaller input/button text */
                padding: 12px 20px !important;
                /* Smaller padding */
            }

            .text-lg {
                /* For messageArea */
                font-size: 1rem !important;
            }

            .text-xl {
                /* For button text */
                font-size: 1.1rem !important;
            }

            .text-sm {
                /* For nav links */
                font-size: 0.85rem !important;
            }

            .text-base {
                /* For nav links */
                font-size: 0.9rem !important;
            }

            .text-4xl {
                /* For logo */
                font-size: 2.5rem !important;
            }

            .text-5xl {
                /* For logo */
                font-size: 3rem !important;
            }
        }
    </style>
</head>

<body
    class="font-inter antialiased bg-[#0D1117] text-[#C9D1D9] leading-relaxed overflow-x-hidden min-h-screen flex flex-col">
    <header
        class="bg-[#161B22] bg-opacity-80 backdrop-blur-md py-3 shadow-2xl flex justify-between items-center sticky top-0 z-50 border-b border-teal-600/20">
        <div class="container mx-auto px-4 sm:px-6 flex justify-between items-center w-full">
            <a href="http://127.0.0.1:5500/FE/index.html" class="text-4xl sm:text-5xl font-extrabold text-teal-400 no-underline inline-block transition-all duration-300 ease-in-out ml-2 sm:ml-4
                      hover:text-teal-300 drop-shadow-lg hover:drop-shadow-xl z-[1001]">
                Cluq
            </a>
            <nav class="mr-2 sm:mr-4">
                <a href="http://127.0.0.1:5500/FE/login.html" class="text-sm sm:text-base text-gray-100 no-underline font-semibold ml-4 sm:ml-6 px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl transition-all duration-300 ease-in-out relative overflow-hidden shine-effect
                          hover:text-teal-300 hover:translate-y-[-2px] z-[1001]">
                    Đăng nhập
                </a>
            </nav>
        </div>
    </header>

    <main class="flex-grow flex items-center justify-center py-10 px-4">
        <div
            class="container mx-auto max-w-md bg-[#161B22] p-8 sm:p-12 rounded-xl shadow-2xl border border-teal-600/30 form-glow-border animate-fadeIn">
            <h2 class="text-4xl font-extrabold text-center mb-8 text-teal-400 drop-shadow-md">Đăng ký tài khoản</h2>
            <form id="registerForm" class="flex flex-col gap-6 relative z-10">
                <div>
                    <label for="account" class="block text-gray-300 text-lg font-semibold mb-2">Tài khoản</label>
                    <input type="text" id="account" name="account" placeholder="Chọn tên tài khoản của bạn" required
                        class="w-full p-4 border-2 border-teal-500 rounded-lg bg-[#0D1117] text-gray-100 text-lg transition-all duration-300 ease-in-out shadow-inner shadow-gray-900/50
                                  placeholder:text-gray-500 placeholder:opacity-70 focus:outline-none focus:border-teal-400 focus:shadow-lg focus:shadow-teal-500/40 focus:bg-[#1A212B]">
                </div>
                <div>
                    <label for="password" class="block text-gray-300 text-lg font-semibold mb-2">Mật khẩu</label>
                    <input type="password" id="password" name="password" placeholder="Tạo mật khẩu" required
                        autocomplete="new-password"
                        class="w-full p-4 border-2 border-teal-500 rounded-lg bg-[#0D1117] text-gray-100 text-lg transition-all duration-300 ease-in-out shadow-inner shadow-gray-900/50
                                  placeholder:text-gray-500 placeholder:opacity-70 focus:outline-none focus:border-teal-400 focus:shadow-lg focus:shadow-teal-500/40 focus:bg-[#1A212B]">
                </div>
                <div>
                    <label for="confirmPassword" class="block text-gray-300 text-lg font-semibold mb-2">Xác nhận mật
                        khẩu</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Nhập lại mật khẩu"
                        required autocomplete="new-password"
                        class="w-full p-4 border-2 border-teal-500 rounded-lg bg-[#0D1117] text-gray-100 text-lg transition-all duration-300 ease-in-out shadow-inner shadow-gray-900/50
                                  placeholder:text-gray-500 placeholder:opacity-70 focus:outline-none focus:border-teal-400 focus:shadow-lg focus:shadow-teal-500/40 focus:bg-[#1A212B]">
                </div>
                <button type="submit" id="registerButton" class="bg-teal-500 text-gray-900 px-8 py-4 text-xl font-bold rounded-xl cursor-pointer transition-all duration-300 ease-in-out w-full shadow-lg shadow-teal-500/40 relative overflow-hidden shine-effect
                               hover:bg-teal-400 hover:translate-y-[-3px] hover:shadow-xl hover:shadow-teal-500/60">
                    Đăng ký
                </button>
            </form>
            <div id="messageArea" class="mt-6 text-center text-lg hidden"></div>
            <p class="mt-6 text-center text-gray-400 relative z-20">
                Đã có tài khoản? <a href="http://127.0.0.1:5500/FE/login.html"
                    class="text-teal-400 hover:underline font-semibold z-20">Đăng nhập ngay</a>
            </p>
        </div>
    </main>

    <footer
        class="bg-[#161B22] py-8 sm:py-10 text-center text-gray-400 text-sm sm:text-base border-t border-teal-600/10 shadow-inner shadow-gray-900/50">
        <div class="container mx-auto px-4 sm:px-5">
            <p>&copy; <span id="year"></span> Cluq. Mọi quyền được bảo lưu.</p>
            <script>
                document.getElementById("year").textContent = new Date().getFullYear();
            </script>
            <br>
            <p>Develope by <a href="https://github.com/shyhubb">Shyhub</a> </p>
        </div>
    </footer>

    <script>
        const AUTH_API_V1_PATH = '/v1/auth';
        const BASE_SHORT_URL_DOMAIN = 'http://localhost:8080'; // Updated backend URL
        const WEB_CONSTANTS_BASE_SUCCESS = 'Thành công.';
        const WEB_CONSTANTS_CONFIRM_PASSWORD_NOT_MACTH = 'Mật khẩu xác nhận không khớp.';
        const WEB_CONSTANTS_ACCOUNT_EXITS = 'Tài khoản này đã tồn tại.';
        const WEB_CONSTANTS_BASE_FAIL = 'Thất bại.';

        document.addEventListener('DOMContentLoaded', () => {
            const registerForm = document.getElementById('registerForm');
            const accountInput = document.getElementById('account');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirmPassword');
            const registerButton = document.getElementById('registerButton');
            const messageArea = document.getElementById('messageArea');

            registerForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                const account = accountInput.value.trim();
                const password = passwordInput.value.trim();
                const confirmPassword = confirmPasswordInput.value.trim();

                if (!account || !password || !confirmPassword) {
                    displayMessage('Vui lòng nhập đầy đủ thông tin.', true);
                    return;
                }

                if (password !== confirmPassword) {
                    displayMessage(WEB_CONSTANTS_CONFIRM_PASSWORD_NOT_MACTH, true);
                    return;
                }

                registerButton.textContent = 'Đang đăng ký...';
                registerButton.disabled = true;
                messageArea.classList.add('hidden'); // Hide previous messages

                try {
                    const apiUrl = BASE_SHORT_URL_DOMAIN + AUTH_API_V1_PATH + '/register';
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        // Đã thêm lại confirmPassword vào payload theo yêu cầu
                        body: JSON.stringify({ account, password, confirmPassword }),
                    });

                    const data = await response.json();
                    console.log('Register API Response Status:', response.status);
                    console.log('Register API Response Message:', data.message);

                    if (response.ok && data.message === WEB_CONSTANTS_BASE_SUCCESS) {
                        displayMessage('Đăng ký thành công! Bạn có thể đăng nhập ngay bây giờ.', false);
                        // Clear form fields
                        accountInput.value = '';
                        passwordInput.value = '';
                        confirmPasswordInput.value = '';
                    } else {
                        displayMessage(data.message || WEB_CONSTANTS_BASE_FAIL, true);
                    }
                } catch (error) {
                    console.error('Lỗi fetch đăng ký:', error);
                    displayMessage('Không thể kết nối đến máy chủ. Vui lòng kiểm tra kết nối mạng hoặc thử lại.', true);
                } finally {
                    registerButton.textContent = 'Đăng ký';
                    registerButton.disabled = false;
                }
            });

            function displayMessage(message, isError) {
                messageArea.textContent = message;
                messageArea.classList.remove('hidden', 'text-green-500', 'text-red-500');
                if (isError) {
                    messageArea.classList.add('text-red-500');
                } else {
                    messageArea.classList.add('text-green-500');
                }
            }
        });
    </script>
</body>

</html>